<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Draggable Pomodoro & Clock</title>
<style>
  body {
    margin: 0;
    height: 100vh;
    overflow: hidden;
    font-family: Arial, Helvetica, sans-serif;
    color: #e5e7eb;
  }

  /* ===== VIDEO BACKGROUND ===== */
  .video-bg {
    position: fixed;
    inset: 0;
    z-index: -2;
    overflow: hidden;
  }
  .video-bg iframe {
    width: 100vw;
    height: 100vh;
    pointer-events: none;
  }

  .overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.6);
    backdrop-filter: blur(6px);
    z-index: -1;
  }

  /* ===== DRAGGABLE PANELS ===== */
  .panel {
    position: absolute;
    background: rgba(2,6,23,0.8);
    padding: 18px 22px;
    border-radius: 16px;
    box-shadow: 0 20px 50px rgba(0,0,0,0.6);
    cursor: grab;
    user-select: none;
  }
  .panel:active { cursor: grabbing; }

  .title { font-size: 1rem; opacity: 0.85; margin-bottom: 6px; }
  .clock { font-size: 2rem; font-weight: bold; }
  .timer { font-size: 2.4rem; margin: 8px 0; }
  .mode { font-size: 0.85rem; opacity: 0.75; }

  button {
    background: #2563eb;
    border: none;
    color: white;
    padding: 8px 12px;
    margin: 4px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 0.8rem;
  }
  button.secondary { background: #334155; }

  .controls { margin-top: 8px; }
</style>
</head>
<body>

<!-- Minecraft Cinematic Ambience (No Copyright) -->
<div class="video-bg">
  <iframe id="bgVideo"
    src="https://www.youtube.com/embed/1sSxYk0YJ3U?autoplay=1&mute=1&loop=1&playlist=1sSxYk0YJ3U&controls=0"
    allow="autoplay">
  </iframe>
</div>
<div class="overlay"></div>

<!-- CLOCK PANEL -->
<div class="panel" id="clockPanel" style="top:40px; left:40px;">
  <div class="title">EST Clock</div>
  <div class="clock" id="estClock">--:--:--</div>
</div>

<!-- POMODORO PANEL -->
<div class="panel" id="pomodoroPanel" style="top:40px; right:40px;">
  <div class="title">Pomodoro</div>
  <div class="mode" id="mode">Work</div>
  <div class="timer" id="timer">25:00</div>

  <div class="controls">
    <button onclick="startTimer()">Start</button>
    <button class="secondary" onclick="pauseTimer()">Pause</button>
    <button class="secondary" onclick="resetTimer()">Reset</button>
  </div>

  <div class="controls">
    <button class="secondary" onclick="toggleSound()">Sound</button>
    <button class="secondary" onclick="toggleFullscreen()">Fullscreen</button>
  </div>
</div>

<!-- Ambient Sound (user interaction required) -->
<audio id="ambientAudio" loop preload="auto">
  <source src="https://cdn.pixabay.com/audio/2023/03/21/audio_7d6b5c0f62.mp3" type="audio/mpeg">
</audio>

<script>
/* ===== DRAG FUNCTION ===== */
function makeDraggable(el) {
  let offsetX = 0, offsetY = 0, dragging = false;

  el.addEventListener('mousedown', e => {
    dragging = true;
    offsetX = e.clientX - el.offsetLeft;
    offsetY = e.clientY - el.offsetTop;
  });

  document.addEventListener('mousemove', e => {
    if (!dragging) return;
    el.style.left = e.clientX - offsetX + 'px';
    el.style.top = e.clientY - offsetY + 'px';
  });

  document.addEventListener('mouseup', () => dragging = false);
}

makeDraggable(clockPanel);
makeDraggable(pomodoroPanel);

/* ===== EST CLOCK ===== */
function updateESTClock() {
  estClock.textContent = new Date().toLocaleTimeString('en-US', { timeZone: 'America/New_York' });
}
setInterval(updateESTClock, 1000);
updateESTClock();

/* ===== POMODORO ===== */
const WORK_TIME = 25 * 60;
const BREAK_TIME = 5 * 60;
let timeLeft = WORK_TIME;
let isRunning = false;
let isWorkMode = true;
let intervalId;

function updateDisplay() {
  const m = Math.floor(timeLeft / 60);
  const s = timeLeft % 60;
  timer.textContent = `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
  mode.textContent = isWorkMode ? 'Work' : 'Break';
}

function startTimer() {
  if (isRunning) return;
  isRunning = true;
  intervalId = setInterval(() => {
    if (timeLeft > 0) timeLeft--;
    else {
      isWorkMode = !isWorkMode;
      timeLeft = isWorkMode ? WORK_TIME : BREAK_TIME;
    }
    updateDisplay();
  }, 1000);
}

function pauseTimer() {
  isRunning = false;
  clearInterval(intervalId);
}

function resetTimer() {
  pauseTimer();
  isWorkMode = true;
  timeLeft = WORK_TIME;
  updateDisplay();
}

/* ===== SOUND FIX ===== */
const ambientAudio = document.getElementById('ambientAudio');
let soundEnabled = false;
function toggleSound() {
  if (!soundEnabled) {
    ambientAudio.volume = 0.6;
    ambientAudio.play();
  } else {
    ambientAudio.pause();
  }
  soundEnabled = !soundEnabled;
}

/* ===== FULLSCREEN ===== */
function toggleFullscreen() {
  if (!document.fullscreenElement) document.documentElement.requestFullscreen();
  else document.exitFullscreen();
}

updateDisplay();
</script>
</body>
</html>

